<!DOCTYPE html>
<html lang="fr">>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Content-Security-Policy" content="img-src 'self' data:;default-src * gap://ready; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'">
    <title>CDispo</title>
    <meta name="viewport" content="height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="format-detection" content="date=no">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="css/mobile.css">
    <script language="javascript">

        // We use this code for handling unexpected errors.
        // Using alert, we are sure that the user get notified in a Mobile device.
        // We add this code at the begining of the index.html and we use only native javascript functions.
        window.onerror = function(msg, url, lineNumber) {
            if (typeof(msg) === "string") {
                var error = msg + "\n\nFile: " + url + "\nLine: " + lineNumber;
                // Ommit cordova and 3rd party libs errors.
                if (url.indexOf("cordova") == -1 && url.indexOf("js") == -1 &&
                        url.indexOf("org.apache.cordova") == -1) {
                    window.alert(error);
                }
            } else {
                var error = msg;
            }

            // This may help debugging if we use logging apps in iOs or Android.
            if(typeof(console) !== "undefined" && typeof(console.log) === "function") {
                console.log(error);
            }

            // Let default error handler run.
            return false;
        };

    </script>
    <script src="cordova.js"></script>
    <script src="js/jquery-1.11.2.min.js"></script>
    <script src="js/jquery.touchswipe.min.js"></script>
    <script src="js/spin.min.js"></script>
    <script src="js/jquery.main.js"></script>

    <script language="javascript">
        // We should wait to phonegap, if not, we get errors like:
        // http://rickluna.com/wp/2012/04/solving-the-connection-to-the-server-was-unsuccessful-error-in-androidphonegap/
        var inAppBrowserRef;
	var loadpage = 0;
	$(document).bind('deviceready', function() {
            	screen.lockOrientation('portrait');
		//StatusBar.overlaysWebView(true);
		//StatusBar.backgroundColorByName("red"); 
            	StatusBar.hide();
		openBrowser();
        });
	$( window ).unload(function() {
		$('.loader2').show();
	});
	function openBrowser() {
		 inAppBrowserRef = cordova.InAppBrowser.open('http://cdispo_preprod.moonlikestudio.com/mobile/connection/?tx_felogin_pi1[forgot]=1', '_blank', 'location=no,hidden=yes');
		 inAppBrowserRef.addEventListener('loadstop', loadStopCallBack);
	}

	function loadStopCallBack() {
		console.log('loadStopCallBack');	
		if (inAppBrowserRef != undefined && loadpage == 0) {
			loadpage = 1;
			console.log('loadpage = 0');
			inAppBrowserRef.show();
			//inAppBrowserRef = cordova.InAppBrowser.open('http://cdispo_preprod.moonlikestudio.com/mobile/connection', '_self', 'location=no,hidden=no');
		}
		if (inAppBrowserRef != undefined && loadpage == 1) {
			console.log('loadpage = 1');
			//inAppBrowserRef.show();
		}
	}
		
    </script>

</head>
<body>
	<div class="loader2" id="loader2"></div>
	<main id="main">
		<div id="cdispo_connexion" class="boxconnection">
			<div class="partner-logo">  
				<img class="logostyle1" src="images/logocdispo2.png" alt="CDispo solution de partage">
			</div>
			
			<div class="tx-felogin-pi1">
				<div class="tx-srfeuserregister-pi1">
					<div class="loginmessage">Entrez votre nom d'utilisateur et votre mot de passe pour vous identifier : toto</div>
					
					<div class="container">
						<form action="http://cdispo_preprod.moonlikestudio.com/mobile/connection/" class="data-form" target="_top" method="post" id="form_seconnecter">

							<div class="colfull">
								<input type="text" id="user" name="user" value="" placeholder="Adresse email" />
							</div>
							<div class="colfull">
								<input type="password" id="pass" name="pass" placeholder="Mot de passe" value="" data-rsa-encryption="" />
							</div>
							<div class="felogin-hidden">
								<input type="hidden" name="logintype" value="login" />
								<input type="hidden" name="pid" value="4" />
								<input type="hidden" name="redirect_url" value="" />
								<input type="hidden" name="tx_felogin_pi1[noredirect]" value="0" />	
							</div>
							
							<div class="col">
								<dt class="checkboxi">
									<label for="permalogin">Rester connecté :
										<input name="permalogin" value="0" type="hidden" disabled="disabled" id="permaloginHiddenField" />
										<input name="permalogin" value="1" type="checkbox" checked="checked" id="permalogin"  onclick="document.getElementById('permaloginHiddenField').disabled = this.checked;" />
									</label>
								</dt>
							</div>
								
							<div class="col">
								<dt class="checkboxi">
									<a href="http://cdispo_preprod.moonlikestudio.com/mobile/connection/?tx_felogin_pi1%5Bforgot%5D=1" rel="nofollow">Mot de passe oublié/expiré ?</a>
								</dt>
							</div>
								
							<div class="colfull">
								<input class="hiddensubmit" id="submitlogin" type="submit" name="submit" value="Adresse email" />
							</div>
						
						</form>
						
						<div class="button-wrapp">
							<a href="javascript:void(0)" class="button green-button" id="connexion">Se connecter</a>
						</div>
						
					</div>

				</div>
			</div>
		</div>
	</main>
</body>
</html>
